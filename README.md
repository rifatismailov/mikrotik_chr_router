# MikroTik CHR —è–∫ –∫–æ—Ä–µ–Ω–µ–≤–∏–π –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤

–¶–µ–π –ø—Ä–æ—î–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î, —è–∫ —Ä–æ–∑–≥–æ—Ä–Ω—É—Ç–∏ MikroTik Cloud Hosted Router (CHR) —É Docker —è–∫ –∫–æ—Ä–µ–Ω–µ–≤–∏–π –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä –¥–ª—è —ñ–Ω—à–∏—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤. –¢–∞–∫–∏–π –ø—ñ–¥—Ö—ñ–¥ –¥–æ–∑–≤–æ–ª—è—î —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –ø–æ–≤–Ω–æ—Ü—ñ–Ω–Ω—É –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü—ñ—é, VLAN/VRF, VPN, NAT, Firewall, WireGuard —Ç–∞ —ñ–Ω—à—ñ —Ñ—É–Ω–∫—Ü—ñ—ó, –¥–æ—Å—Ç—É–ø–Ω—ñ –≤ MikroTik, –ø—Ä—è–º–æ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω–æ—ó —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∏.
–•–æ—á–∞ –∑–∞–¥—É–º–∞–∫–∞ —Å–ø—Ä–∞—Ü—é–≤–∞–ª–∞ –Ω–µ –∑ –ø–µ—Ä—à–æ–≥–æ —Ä–∞–∑—É –∞–ª–µ —è –ø–æ–∫–∞–∑—É—é —è–∫ —è —Ü–µ —Ä–µ–∞–ª—ñ–∑—É–≤–∞–≤.

–î–ª—è –ø–æ—á—Ç–∫—É –≤–∞–º —Ç—Ä–µ–±–∞ –ø—ñ–¥–Ω—è—Ç–∏ docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä mikrotik-chr –∑ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞–º–∏. –í –º–æ—î–º—É –≤–∏–ø–∞–∫—É —è —Ä–µ–∞–ª—ñ–∑—É–≤–∞–≤ 5 —ñ–Ω—Ç–µ—Ä–µ—Ä—Ñ–µ–π—Å—ñ–≤ mikrotik_net_a —Ç–∞ mikrotik_net_e —Ü–µ –æ—Å—Ç–∞–Ω–Ω—ñ–π. –î–µ –≤ –º–µ–Ω–µ mikrotik_net_a –≤–∏–∫–æ–Ω—É—î —Ä–æ–ª—å –≤—Ö—ñ–¥–Ω–æ–≥–æ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É –¥–ª—è Wan 

---

## üîß Docker Compose (`docker-compose.yml`)

```yaml
version: "3.8"

services:
  mikrotik-chr:
    image: mikrotik/chr
    container_name: chr-router
    privileged: true
    restart: unless-stopped
    ports:
      - "8291:8291"            # WinBox
      - "51820:51820/udp"      # WireGuard
      - "1701:1701/udp"        # L2TP VPN
    networks:
      mikrotik_net_a:
        ipv4_address: 172.21.0.2
      mikrotik_net_b:
        ipv4_address: 192.168.1.2
      mikrotik_net_c:
        ipv4_address: 192.168.2.2
      mikrotik_net_d:
        ipv4_address: 192.168.3.2
      mikrotik_net_e:
        ipv4_address: 192.168.4.2

networks:
  mikrotik_net_a:
    name: mikrotik_net_a
    driver: bridge
    ipam:
      config:
        - subnet: 172.21.0.0/24
          gateway: 172.21.0.1
  mikrotik_net_b:
    name: mikrotik_net_b
    driver: bridge
    ipam:
      config:
        - subnet: 192.168.1.0/24
          gateway: 192.168.1.1
  mikrotik_net_c:
    name: mikrotik_net_c
    driver: bridge
    ipam:
      config:
        - subnet: 192.168.2.0/24
          gateway: 192.168.2.1
  mikrotik_net_d:
    name: mikrotik_net_d
    driver: bridge
    ipam:
      config:
        - subnet: 192.168.3.0/24
          gateway: 192.168.3.1
  mikrotik_net_e:
    name: mikrotik_net_e
    driver: bridge
    ipam:
      config:
        - subnet: 192.168.4.0/24
          gateway: 192.168.4.1
```

---

## üìú MikroTik CHR RSC —Å–∫—Ä–∏–ø—Ç (—ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–∞)
–î–∞–ª—ñ —è —Å—Ç–≤–æ—Ä–∏–≤ RSC-—Å–∫—Ä–∏–ø—Ç
–¶–µ–π RSC-—Å–∫—Ä–∏–ø—Ç –≤–∏–∫–æ–Ω—É—î —Ç–∞–∫—ñ –¥—ñ—ó:

- –æ—á–∏—â–µ–Ω–Ω—è –≤—Å—ñ—Ö –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ—Ö –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å
- –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è WAN (DHCP + –º–∞—Ä—à—Ä—É—Ç –ø–æ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—é)
- —Ä–æ–∑–ø–æ–¥—ñ–ª LAN –ø–æ 4 —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞—Ö
- –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é DHCP —Å–µ—Ä–≤–µ—Ä—ñ–≤
- –¥–æ–¥–∞–≤–∞–Ω–Ω—è WireGuard
- –±–∞–∑–æ–≤—ñ –ø—Ä–∞–≤–∏–ª–∞ —Ñ–∞—î—Ä–≤–æ–ª—É

–§–∞–π–ª: `init-config.rsc`

> üîΩ (–ø–æ–≤–Ω–∏–π –≤–º—ñ—Å—Ç –¥–∏–≤. —É –≤–∏—Ö—ñ–¥–Ω–æ–º—É —Ñ–∞–π–ª—ñ –∞–±–æ –æ–∫—Ä–µ–º–æ–º—É —Ä–æ–∑–¥—ñ–ª—ñ)

---

–ü—ñ—Å—è–ª —Ü—ñ—Ö –¥—ñ—ó –Ω–∞–º —Ç—Ä–µ–±–∞ –±—É–ª–æ —è–∫–æ—Å—å —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –¥—Å–æ—Ç—É–ø –¥–æ –º–µ—Ä–µ–∂—ñ —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç —Ç–∞ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –ø—ñ–¥–∫–ª—á–µ–Ω–Ω—è –¥–æ —Ü—å–æ–≥–æ MikroTik —ñ–∑ –∑–æ–≤–Ω—ñ –±–æ —Ç–∞–∫ —è–∫ —ñ–∑ —Å–µ—Ä–µ–¥–∏–Ω–∏ –º–∏ –Ω–µ –º–æ–∂–µ–º–æ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤ –æ–∫—Ä—ñ–º CLI –∑ docker. –Ø –≤–∏–∫–æ—Ä–∏—Å—Ç—É–≤–∞–≤ WireGuard —Ç–∞ –ø—Ä–æ–ø—Ä–æ—Å –ø–æ—Ä—Ç—ñ–≤ –¥–ª—è —Ü—å–æ–≥–æ –≤–ø–Ω, –∞ —Ç–∞–∫–æ–∂ –∑—Ä–æ–±–∏–≤ –¥–æ–¥–∞—Ç–∫–æ–æ–≤–æ –ø—Ä–æ–±—Ä–æ—Å –¥–ª—è L2TP –¥–ª—è –ø–æ–¥–∞–ª—à–∏—Ö –¥—ñ—ó –Ω–∞ –º–∞–π–±—É—Ç–Ω–µ —Ç–∞ –ø–æ—Ä—Ç 8291 –¥–ª—è WinBox. 
–î–ª—è –ø–æ–≤–Ω–æ—ó —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó –±—É–ª–æ —Å—Ç–≤–æ—Ä–µ–Ω–∞ bash —Å–∫—Ä–∏–ø iptables-setup.sh –¥–ª—è NAT/DNAT —á–µ—Ä–µ–∑ iptables.

## üîí Bash-—Å–∫—Ä–∏–ø—Ç –¥–ª—è NAT/DNAT —á–µ—Ä–µ–∑ iptables

–°–∫—Ä–∏–ø—Ç `iptables-setup.sh` –¥–æ–∑–≤–æ–ª—è—î –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ DNAT —Ç–∞ –º–∞—Å–∫–∞—Ä–∞–¥–∏–Ω–≥ –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ MikroTik —ñ–∑ –∑–æ–≤–Ω—ñ—à–Ω—å–æ—ó LAN –º–µ—Ä–µ–∂—ñ. –í—ñ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø–µ—Ä–µ–º–∏–∫–∞—î iptables –Ω–∞ `legacy`, –¥–æ–¥–∞—î DNAT, FORWARD —ñ MASQUERADE –ø—Ä–∞–≤–∏–ª–∞, —ñ –∞–∫—Ç–∏–≤—É—î IP forwarding.

### –û—Å–Ω–æ–≤–Ω—ñ –∑–∞–¥–∞—á—ñ:

- DNAT/forward –ø–æ—Ä—Ç—ñ–≤ (WinBox, WireGuard, L2TP)
- –ú–∞—Å–∫–∞—Ä–∞–¥–∏–Ω–≥ –¥–ª—è –∑–≤–æ—Ä–æ—Ç–Ω–æ–≥–æ —Ç—Ä–∞—Ñ—ñ–∫—É
- –î–æ–∑–≤—ñ–ª —Ç—Ä–∞—Ñ—ñ–∫—É –∑ –ª–æ–∫–∞–ª—å–Ω–æ—ó –º–µ—Ä–µ–∂—ñ
- –í–∏–≤—ñ–¥ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏

–§–∞–π–ª: `iptables-setup.sh`

---

## ‚úÖ –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –∫–ª—ñ—î–Ω—Ç—ñ–≤ —á–µ—Ä–µ–∑ WireGuard

WireGuard —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å `wg0` —Å–ª—É—Ö–∞—î –Ω–∞ `51820/udp`, –º–∞—î –∞–¥—Ä–µ—Å—É `10.0.0.1/24` —ñ –¥–æ–∑–≤–æ–ª—è—î –¥–æ—Å—Ç—É–ø –∫–ª—ñ—î–Ω—Ç–∞–º `10.0.0.2` —Ç–∞ `10.0.0.3`. –ü—Ä–∞–≤–∏–ª–∞ —Ñ–∞—î—Ä–≤–æ–ª—É –¥–æ–∑–≤–æ–ª—è—é—Ç—å granular –¥–æ—Å—Ç—É–ø –¥–æ –ø—ñ–¥–º–µ—Ä–µ–∂, –∑–æ–∫—Ä–µ–º–∞:

- `10.0.0.2` –º–∞—î –ø–æ–≤–Ω–∏–π –¥–æ—Å—Ç—É–ø –¥–æ –≤—Å—ñ—Ö LAN
- `10.0.0.3` –æ–±–º–µ–∂–µ–Ω–æ (—Ç—ñ–ª—å–∫–∏ –¥–æ –¥–µ—è–∫–∏—Ö LAN)

---

## üß™ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞

1. **WinBox –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è:** IP `192.168.88.200:8291` 192.168.88.200 —Ü–µ IP –º–æ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ –≤ –≤–∞—Å –º–æ–∂–µ –±—É—Ç–∏ —ñ–Ω—à–∏–π. 
2. **WireGuard –∫–ª—ñ—î–Ω—Ç–∏:** —á–µ—Ä–µ–∑ –ø—É–±–ª—ñ—á–Ω—ñ –∫–ª—é—á—ñ
3. **DHCP –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞:** –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏ –æ—Ç—Ä–∏–º—É—é—Ç—å IP –≤—ñ–¥ MikroTik
4. **–ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü—ñ—è:** –∑ —ñ–Ω—à–∏—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤ —î –¥–æ—Å—Ç—É–ø –¥–æ –∑–æ–≤–Ω—ñ—à–Ω—å–æ—ó –º–µ—Ä–µ–∂—ñ —á–µ—Ä–µ–∑ MikroTik

---

## üìå –ü—Ä–∏–º—ñ—Ç–∫–∏

- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—É `mikrotik-chr` **–ø–æ—Ç—Ä—ñ–±–µ–Ω —Ä–µ–∂–∏–º **`` –¥–ª—è –∫–æ—Ä–µ–∫—Ç–Ω–æ—ó —Ä–æ–±–æ—Ç–∏ –∑ –º–µ—Ä–µ–∂–∞–º–∏.
- –°–∫—Ä–∏–ø—Ç–∏ —Å–ª—ñ–¥ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –∑ –ø—Ä–∞–≤–∞–º–∏ `sudo`.
- MikroTik CHR –ø—ñ–¥—Ç—Ä–∏–º—É—î RouterOS –ø–æ–≤–Ω—ñ—Å—Ç—é: –º–æ–∂–Ω–∞ —Ä–æ–∑–≥–æ—Ä—Ç–∞—Ç–∏ hotspot, VPN, tunnels, firewall scripts —Ç–æ—â–æ.

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é

```
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ init-config.rsc
‚îú‚îÄ‚îÄ iptables-setup.sh
‚îî‚îÄ‚îÄ README.md (—Ü—è —Å—Ç–∞—Ç—Ç—è)
```

---

## üìé TODO

-

---

–ó–∞–ª–∏—à–∞–π—Å—è –∑ –Ω–∞–º–∏, –¥–∞–ª—ñ –±—É–¥–µ üî•

